(self.webpackChunkkana_test=self.webpackChunkkana_test||[]).push([[754],{163:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GameModule:()=>j});var a=r(583),s=r(238),n=r(215),i=r(435);class o{constructor(e){this.dictionary={},this.init(e)}init(e){e.forEach(e=>{this.dictionary[e.upperCase]={transcription:e.transcription,letterName:e.letterName},this.dictionary[e.lowerCase]={transcription:e.transcription,letterName:e.letterName}})}getTranscription(e){var t;return(null===(t=this.dictionary[e])||void 0===t?void 0:t.transcription)?this.dictionary[e].transcription:null}getLetterName(e){var t;return(null===(t=this.dictionary[e])||void 0===t?void 0:t.letterName)?this.dictionary[e].transcription:null}getAllTranscriptions(){const e={};return Object.keys(this.dictionary).forEach(t=>{e[t]=this.dictionary[t].transcription}),e}}const p=[{upperCase:"\u0531",lowerCase:"\u0561",transcription:"a",letterName:"ayb"},{upperCase:"\u0532",lowerCase:"\u0562",transcription:"b",letterName:"ben"},{upperCase:"\u0533",lowerCase:"\u0563",transcription:"g",letterName:"gim"},{upperCase:"\u0534",lowerCase:"\u0564",transcription:"d",letterName:"da"},{upperCase:"\u0535",lowerCase:"\u0565",transcription:"ye",letterName:"yech"},{upperCase:"\u0536",lowerCase:"\u0566",transcription:"z",letterName:"za"},{upperCase:"\u0537",lowerCase:"\u0567",transcription:"e",letterName:"e"},{upperCase:"\u0538",lowerCase:"\u0568",transcription:"e",letterName:"yit"},{upperCase:"\u0539",lowerCase:"\u0569",transcription:"th",letterName:"tho"},{upperCase:"\u053a",lowerCase:"\u056a",transcription:"zh",letterName:"zhe"},{upperCase:"\u053b",lowerCase:"\u056b",transcription:"i",letterName:"ini"},{upperCase:"\u053c",lowerCase:"\u056c",transcription:"l",letterName:"livn"},{upperCase:"\u053d",lowerCase:"\u056d",transcription:"h",letterName:"he"},{upperCase:"\u053e",lowerCase:"\u056e",transcription:"cz",letterName:"cza"},{upperCase:"\u053f",lowerCase:"\u056f",transcription:"k",letterName:"ken"},{upperCase:"\u0540",lowerCase:"\u0570",transcription:"h",letterName:"ho"},{upperCase:"\u0541",lowerCase:"\u0571",transcription:"dz",letterName:"dza"},{upperCase:"\u0542",lowerCase:"\u0572",transcription:"y",letterName:"yat"},{upperCase:"\u0543",lowerCase:"\u0573",transcription:"ch",letterName:"che"},{upperCase:"\u0544",lowerCase:"\u0574",transcription:"m",letterName:"men"},{upperCase:"\u0545",lowerCase:"\u0575",transcription:"y",letterName:"yi"},{upperCase:"\u0546",lowerCase:"\u0576",transcription:"n",letterName:"nu"},{upperCase:"\u0547",lowerCase:"\u0577",transcription:"sh",letterName:"sha"},{upperCase:"\u0548",lowerCase:"\u0578",transcription:"o",letterName:"vo"},{upperCase:"\u0549",lowerCase:"\u0579",transcription:"ch",letterName:"cha"},{upperCase:"\u054a",lowerCase:"\u057a",transcription:"p",letterName:"pe"},{upperCase:"\u054b",lowerCase:"\u057b",transcription:"dzh",letterName:"dzhe"},{upperCase:"\u054c",lowerCase:"\u057c",transcription:"r",letterName:"rra"},{upperCase:"\u054d",lowerCase:"\u057d",transcription:"s",letterName:"se"},{upperCase:"\u054e",lowerCase:"\u057e",transcription:"v",letterName:"veu"},{upperCase:"\u054f",lowerCase:"\u057f",transcription:"t",letterName:"tivn"},{upperCase:"\u0550",lowerCase:"\u0580",transcription:"r",letterName:"re"},{upperCase:"\u0551",lowerCase:"\u0581",transcription:"cz",letterName:"czo"},{upperCase:"\u0552",lowerCase:"\u0582",transcription:"u",letterName:"u"},{upperCase:"\u0553",lowerCase:"\u0583",transcription:"p",letterName:"pivr"},{upperCase:"\u0554",lowerCase:"\u0584",transcription:"k",letterName:"ke"},{upperCase:"\u0555",lowerCase:"\u0585",transcription:"o",letterName:"o"},{upperCase:"\u0535\u057e",lowerCase:"\u0587",transcription:"ev",letterName:"ev"},{upperCase:"\u0556",lowerCase:"\u0586",transcription:"f",letterName:"fe"}],c=[{upperCase:"\u3042",lowerCase:"\u3042",transcription:"a",letterName:"a"},{upperCase:"\u304b",lowerCase:"\u304b",transcription:"ka",letterName:"ka"},{upperCase:"\u3055",lowerCase:"\u3055",transcription:"sa",letterName:"sa"},{upperCase:"\u305f",lowerCase:"\u305f",transcription:"ta",letterName:"ta"},{upperCase:"\u306a",lowerCase:"\u306a",transcription:"na",letterName:"na"},{upperCase:"\u306f",lowerCase:"\u306f",transcription:"ha",letterName:"ha"},{upperCase:"\u307e",lowerCase:"\u307e",transcription:"ma",letterName:"ma"},{upperCase:"\u3084",lowerCase:"\u3084",transcription:"ya",letterName:"ya"},{upperCase:"\u3089",lowerCase:"\u3089",transcription:"ra",letterName:"ra"},{upperCase:"\u308f",lowerCase:"\u308f",transcription:"wa",letterName:"wa"},{upperCase:"\u3044",lowerCase:"\u3044",transcription:"i",letterName:"i"},{upperCase:"\u304d",lowerCase:"\u304d",transcription:"ki",letterName:"ki"},{upperCase:"\u3057",lowerCase:"\u3057",transcription:"shi",letterName:"shi"},{upperCase:"\u3061",lowerCase:"\u3061",transcription:"chi",letterName:"chi"},{upperCase:"\u306b",lowerCase:"\u306b",transcription:"ni",letterName:"ni"},{upperCase:"\u3072",lowerCase:"\u3072",transcription:"hi",letterName:"hi"},{upperCase:"\u307f",lowerCase:"\u307f",transcription:"mi",letterName:"mi"},{upperCase:"\u308a",lowerCase:"\u308a",transcription:"ri",letterName:"ri"},{upperCase:"\u3046",lowerCase:"\u3046",transcription:"u",letterName:"u"},{upperCase:"\u304f",lowerCase:"\u304f",transcription:"ku",letterName:"ku"},{upperCase:"\u3059",lowerCase:"\u3059",transcription:"su",letterName:"su"},{upperCase:"\u3064",lowerCase:"\u3064",transcription:"tsu",letterName:"tsu"},{upperCase:"\u306c",lowerCase:"\u306c",transcription:"nu",letterName:"nu"},{upperCase:"\u3075",lowerCase:"\u3075",transcription:"fu",letterName:"fu"},{upperCase:"\u3080",lowerCase:"\u3080",transcription:"mu",letterName:"mu"},{upperCase:"\u3086",lowerCase:"\u3086",transcription:"yu",letterName:"yu"},{upperCase:"\u308b",lowerCase:"\u308b",transcription:"ru",letterName:"ru"},{upperCase:"\u3048",lowerCase:"\u3048",transcription:"e",letterName:"e"},{upperCase:"\u3051",lowerCase:"\u3051",transcription:"ke",letterName:"ke"},{upperCase:"\u305b",lowerCase:"\u305b",transcription:"se",letterName:"se"},{upperCase:"\u3066",lowerCase:"\u3066",transcription:"te",letterName:"te"},{upperCase:"\u306d",lowerCase:"\u306d",transcription:"ne",letterName:"ne"},{upperCase:"\u3078",lowerCase:"\u3078",transcription:"he",letterName:"he"},{upperCase:"\u3081",lowerCase:"\u3081",transcription:"me",letterName:"me"},{upperCase:"\u308c",lowerCase:"\u308c",transcription:"re",letterName:"re"},{upperCase:"\u304a",lowerCase:"\u304a",transcription:"o",letterName:"o"},{upperCase:"\u3053",lowerCase:"\u3053",transcription:"ko",letterName:"ko"},{upperCase:"\u305d",lowerCase:"\u305d",transcription:"so",letterName:"so"},{upperCase:"\u3068",lowerCase:"\u3068",transcription:"to",letterName:"to"},{upperCase:"\u306e",lowerCase:"\u306e",transcription:"no",letterName:"no"},{upperCase:"\u307b",lowerCase:"\u307b",transcription:"ho",letterName:"ho"},{upperCase:"\u3082",lowerCase:"\u3082",transcription:"mo",letterName:"mo"},{upperCase:"\u3088",lowerCase:"\u3088",transcription:"yo",letterName:"yo"},{upperCase:"\u308d",lowerCase:"\u308d",transcription:"ro",letterName:"ro"},{upperCase:"\u3092",lowerCase:"\u3092",transcription:"wo",letterName:"wo"},{upperCase:"\u3093",lowerCase:"\u3093",transcription:"n",letterName:"n"}],l=[{upperCase:"\u30a2",lowerCase:"\u30a2",transcription:"a",letterName:"a"},{upperCase:"\u30ab",lowerCase:"\u30ab",transcription:"ka",letterName:"ka"},{upperCase:"\u30b5",lowerCase:"\u30b5",transcription:"sa",letterName:"sa"},{upperCase:"\u30bf",lowerCase:"\u30bf",transcription:"ta",letterName:"ta"},{upperCase:"\u30ca",lowerCase:"\u30ca",transcription:"na",letterName:"na"},{upperCase:"\u30cf",lowerCase:"\u30cf",transcription:"ha",letterName:"ha"},{upperCase:"\u30de",lowerCase:"\u30de",transcription:"ma",letterName:"ma"},{upperCase:"\u30e4",lowerCase:"\u30e4",transcription:"ya",letterName:"ya"},{upperCase:"\u30e9",lowerCase:"\u30e9",transcription:"ra",letterName:"ra"},{upperCase:"\u30ef",lowerCase:"\u30ef",transcription:"wa",letterName:"wa"},{upperCase:"\u30a4",lowerCase:"\u30a4",transcription:"i",letterName:"i"},{upperCase:"\u30ad",lowerCase:"\u30ad",transcription:"ki",letterName:"ki"},{upperCase:"\u30b7",lowerCase:"\u30b7",transcription:"shi",letterName:"shi"},{upperCase:"\u30c1",lowerCase:"\u30c1",transcription:"chi",letterName:"chi"},{upperCase:"\u30cb",lowerCase:"\u30cb",transcription:"ni",letterName:"ni"},{upperCase:"\u30d2",lowerCase:"\u30d2",transcription:"hi",letterName:"hi"},{upperCase:"\u30df",lowerCase:"\u30df",transcription:"mi",letterName:"mi"},{upperCase:"\u30ea",lowerCase:"\u30ea",transcription:"ri",letterName:"ri"},{upperCase:"\u30a6",lowerCase:"\u30a6",transcription:"u",letterName:"u"},{upperCase:"\u30af",lowerCase:"\u30af",transcription:"ku",letterName:"ku"},{upperCase:"\u30b9",lowerCase:"\u30b9",transcription:"su",letterName:"su"},{upperCase:"\u30c4",lowerCase:"\u30c4",transcription:"tsu",letterName:"tsu"},{upperCase:"\u30cc",lowerCase:"\u30cc",transcription:"nu",letterName:"nu"},{upperCase:"\u30d5",lowerCase:"\u30d5",transcription:"fu",letterName:"fu"},{upperCase:"\u30e0",lowerCase:"\u30e0",transcription:"mu",letterName:"mu"},{upperCase:"\u30e6",lowerCase:"\u30e6",transcription:"yu",letterName:"yu"},{upperCase:"\u30eb",lowerCase:"\u30eb",transcription:"ru",letterName:"ru"},{upperCase:"\u30a8",lowerCase:"\u30a8",transcription:"e",letterName:"e"},{upperCase:"\u30b1",lowerCase:"\u30b1",transcription:"ke",letterName:"ke"},{upperCase:"\u30bb",lowerCase:"\u30bb",transcription:"se",letterName:"se"},{upperCase:"\u30c6",lowerCase:"\u30c6",transcription:"te",letterName:"te"},{upperCase:"\u30cd",lowerCase:"\u30cd",transcription:"ne",letterName:"ne"},{upperCase:"\u30d8",lowerCase:"\u30d8",transcription:"he",letterName:"he"},{upperCase:"\u30e1",lowerCase:"\u30e1",transcription:"me",letterName:"me"},{upperCase:"\u30ec",lowerCase:"\u30ec",transcription:"re",letterName:"re"},{upperCase:"\u30aa",lowerCase:"\u30aa",transcription:"o",letterName:"o"},{upperCase:"\u30b3",lowerCase:"\u30b3",transcription:"ko",letterName:"ko"},{upperCase:"\u30bd",lowerCase:"\u30bd",transcription:"so",letterName:"so"},{upperCase:"\u30c8",lowerCase:"\u30c8",transcription:"to",letterName:"to"},{upperCase:"\u30ce",lowerCase:"\u30ce",transcription:"no",letterName:"no"},{upperCase:"\u30db",lowerCase:"\u30db",transcription:"ho",letterName:"ho"},{upperCase:"\u30e2",lowerCase:"\u30e2",transcription:"mo",letterName:"mo"},{upperCase:"\u30e8",lowerCase:"\u30e8",transcription:"yo",letterName:"yo"},{upperCase:"\u30ed",lowerCase:"\u30ed",transcription:"ro",letterName:"ro"},{upperCase:"\u30f2",lowerCase:"\u30f2",transcription:"wo",letterName:"wo"},{upperCase:"\u30f3",lowerCase:"\u30f3",transcription:"n",letterName:"n"}];var u=r(639),C=r(574),m=r(796),h=r(105),w=r(2);function N(e,t,r,a){return(0,h.m)(r)&&(a=r,r=void 0),a?N(e,t,r).pipe((0,w.U)(e=>(0,m.k)(e)?a(...e):a(e))):new C.y(a=>{d(e,t,function(e){a.next(arguments.length>1?Array.prototype.slice.call(arguments):e)},a,r)})}function d(e,t,r,a,s){let n;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){const a=e;e.addEventListener(t,r,s),n=()=>a.removeEventListener(t,r,s)}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){const a=e;e.on(t,r),n=()=>a.off(t,r)}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){const a=e;e.addListener(t,r),n=()=>a.removeListener(t,r)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let n=0,i=e.length;n<i;n++)d(e[n],t,r,a,s)}a.add(n)}let f=(()=>{class e{constructor(e){this.document=e}getKeyPressedObservable(){return this.keyPressed||(this.keyPressed=N(this.document.body,"keypress")),this.keyPressed}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(a.K0))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var y=r(317);function g(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",6),u.TgZ(1,"input",7),u.NdJ("input",function(t){return u.CHM(e),u.oxw().onMobileInputChange(t)}),u.qZA(),u.qZA()}}let b=(()=>{class e{constructor(e,t){this.eventsService=e,this.activatedRoute=t,this.alphabets=[],this.currentTyping="",this.currentKana="",this.expectedTranscription="",this.queue=[],this.isMissed=!1,this.lastCorrectTime=0,this.score=0,this.hint="",this.vacabulary={},this.nextKanaSubject=new n.X("false"),this.incorrectSubject=new n.X("false"),this.supportsTouch=!1,this.subscriptions=[],this.mobileKeyPressed$=new n.X(null),this.supportsTouch="ontouchstart"in window||navigator.msMaxTouchPoints,this.keyPressed$=this.eventsService.getKeyPressedObservable(),this.activatedRoute.params.subscribe(e=>console.log(e)),this.alphabets=[this.activatedRoute.snapshot.params.alph]}onMobileInputChange(e){console.log(e),e.preventDefault(),e.stopPropagation();const t=e.target.value.slice(-1);this.mobileKeyPressed$.next({key:t}),e.target.value=""}createVacabulary(){let e={};return this.alphabets.forEach(t=>{switch(t){case"hiragana":e=Object.assign(Object.assign({},e),new o(c).getAllTranscriptions());break;case"katakana":e=Object.assign(Object.assign({},e),new o(l).getAllTranscriptions());break;case"armenian":e=Object.assign(Object.assign({},e),new o(p).getAllTranscriptions());break;default:0===Object.keys(e).length&&console.warn(`No matches for alphabet "${t}"`)}}),e}ngOnInit(){const e=this.keyPressed$.subscribe(e=>this.onKeyPressed(e.key)),t=this.mobileKeyPressed$.pipe((0,i.h)(e=>!!e)).subscribe(e=>this.onKeyPressed(e.key)),r=this.nextKanaSubject.pipe((0,i.h)(e=>"false"===e)).subscribe(()=>this.nextKana());this.subscriptions.push(e,r,t),this.startNewGame()}onCorrectAnimationDone(e){"false"===e.fromState&&this.nextKanaSubject.next("false")}onIncorrectAnimationDone(e){"false"===e.fromState&&this.incorrectSubject.next("false")}onHint(){this.hint=this.vacabulary[this.currentKana]}nextKana(){this.currentKana&&this.setScore(),this.hint="",this.clearTyping(),this.currentKana=this.queue.pop()||"",""!==this.currentKana&&(this.expectedTranscription=this.vacabulary[this.currentKana])}setScore(){let e=this.isMissed?1:2,t=(+new Date-this.lastCorrectTime)/1e3,r=Math.round(1e3-(t>5?1e3:200*t));this.score+=(250+r)*e,this.isMissed=!1,this.lastCorrectTime=+new Date}clearTyping(){this.currentTyping=""}onKeyPressed(e){if(this.currentTyping+=e,!this.expectedTranscription.startsWith(this.currentTyping))return this.clearTyping(),void this.incorrectSubject.next("true");this.expectedTranscription===this.currentTyping&&this.nextKanaSubject.next("true")}startNewGame(){this.currentKana="",this.currentTyping="",this.expectedTranscription="",this.score=0,this.isMissed=!1,this.vacabulary=this.createVacabulary(),this.queue=Object.keys(this.vacabulary),function(e){let t=e.length;for(;0!==t;){const r=Math.floor(Math.random()*t);t--,[e[r],e[t]]=[e[t],e[r]]}}(this.queue),this.nextKana()}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(f),u.Y36(y.gz))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-game"]],decls:22,vars:12,consts:[["class","mobile",4,"ngIf"],[1,"container"],[1,"current-typing"],[1,"current-kana"],[1,"counter"],[3,"click"],[1,"mobile"],["placeholder","Tap to open keyboard","type","text","autocapitalize","off",3,"input"]],template:function(e,t){1&e&&(u._UZ(0,"div"),u.TgZ(1,"h3"),u._uU(2,"Game"),u.qZA(),u.YNc(3,g,2,0,"div",0),u.TgZ(4,"div",1),u.TgZ(5,"div",2),u._uU(6),u.qZA(),u.TgZ(7,"div",3),u.NdJ("@correct.done",function(e){return t.onCorrectAnimationDone(e)})("@incorrect.done",function(e){return t.onIncorrectAnimationDone(e)}),u.ALo(8,"async"),u.ALo(9,"async"),u._uU(10),u.qZA(),u.qZA(),u.TgZ(11,"div",4),u.TgZ(12,"div"),u._uU(13),u.TgZ(14,"button",5),u.NdJ("click",function(){return t.onHint()}),u._uU(15,"Hint"),u.qZA(),u.TgZ(16,"span"),u._uU(17),u.qZA(),u.qZA(),u.qZA(),u.TgZ(18,"div"),u._uU(19),u.qZA(),u.TgZ(20,"button",5),u.NdJ("click",function(){return t.startNewGame()}),u._uU(21,"Reset"),u.qZA()),2&e&&(u.xp6(3),u.Q6J("ngIf",t.supportsTouch),u.xp6(3),u.hij(" ",t.currentTyping," "),u.xp6(1),u.Q6J("@correct",u.lcZ(8,8,t.nextKanaSubject))("@incorrect",u.lcZ(9,10,t.incorrectSubject)),u.xp6(3),u.hij(" ",t.currentKana," "),u.xp6(3),u.hij(" Kanas left: ",t.queue.length," "),u.xp6(4),u.Oqu(t.hint),u.xp6(2),u.hij("Score: ",t.score,""))},directives:[a.O5],pipes:[a.Ov],styles:[".counter[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.container[_ngcontent-%COMP%]   .current-kana[_ngcontent-%COMP%]{font-size:140px;font-family:Times New Roman,Times,serif}.current-typing[_ngcontent-%COMP%]{font-size:22px;color:grey;min-height:26px}.mobile[_ngcontent-%COMP%]{display:flex;justify-content:center}.mobile[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;text-align:center;caret-color:#0000}"],data:{animation:[(0,s.X$)("correct",[(0,s.SB)("false",(0,s.oB)({color:"black",transform:"scale(1)",opacity:"1"})),(0,s.SB)("true",(0,s.oB)({color:"green",transform:"scale(1.2)",opacity:"0"})),(0,s.eR)("* => false",(0,s.jt)("0ms")),(0,s.eR)("* => true",(0,s.jt)("150ms"))]),(0,s.X$)("incorrect",[(0,s.SB)("false",(0,s.oB)({color:"black",transform:"scale(1)"})),(0,s.SB)("true",(0,s.oB)({color:"red",transform:"scale(0.9)"})),(0,s.eR)("* => false",(0,s.jt)("0ms")),(0,s.eR)("* => true",(0,s.jt)("150ms"))])]}}),e})();const v=[{path:"",component:b}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[y.Bz.forChild(v)],y.Bz]}),e})();var T=r(665);const x=[{path:":alph",component:b}];let j=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[a.ez,T.u5,y.Bz.forChild(x),k]]}),e})()}}]);